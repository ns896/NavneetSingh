import"./faceplate-switch-input-084d3f59.js";import{_ as e,n as t,h as s,s as o,x as i}from"./icon-333959f6.js";import{d7 as n,dv as r,a4 as a,a5 as d,dw as c,d8 as l,dx as p,dy as h,dz as y,dA as m}from"./shell-010f89b8.js";import{u}from"./community-colors-259f817c.js";import{D as f}from"./display-theme-7e251d41.js";import"./checked-input-element-c27a5688.js";import"./faceplate-input-2a2c1f51.js";import"./input-element-e9f4def4.js";import"./form-common-utils-8fdfcdc2.js";import"./constants-3ee6bdfd.js";let b=class extends o{constructor(){super(...arguments),this.enabled=!1,this.country=""}handler(e){e.preventDefault(),n({country:this.country,name:r,value:this.enabled?"false":"true"}),window.location.reload()}render(){return i`<div @click="${this.handler}" @keypress="${this.handler}">\n <slot></slot>\n </div>`}};e([t({type:Boolean})],b.prototype,"enabled",void 0),e([t({type:String})],b.prototype,"country",void 0),b=e([s("shreddit-modmode-setter")],b);let k=class extends o{constructor(){super(...arguments),this.enabled=!1,this.country="",this.cookieDomain="",this.sync=!1}async connectedCallback(){super.connectedCallback(),this.sync&&this.syncCookieToUserPreference()}async syncCookieToUserPreference(){try{const{data:e}=await a({operation:d.IdentityUserPreferences,variables:{includeNightMode:!0}}),t=e.identity?.preferences?.isNightModeEnabled;if(null==t)return;t!==this.enabled&&(this.enabled=t,this.updateClientStyles(),this.setCookie(),this.reportMismatch())}catch{}}setCookie(){n({country:this.country,name:c,value:this.enabled?f.Darkmode:f.Lightmode,options:{...l,domain:this.cookieDomain||void 0}})}async setUserPreference(){await a({operation:d.UpdateAccountPreferences,variables:{input:{isNightModeEnabled:this.enabled}}})}updateClientStyles(){u({isDarkMode:this.enabled});const e=this.querySelector("faceplate-switch-input");e&&(e.checked=this.enabled)}reportMismatch(){const e=p(this.country)&&!h(),t={cookies_enabled:navigator.cookieEnabled&&!e?"true":"false"};y({type:m.Counter,name:"shreddit_darkmode_preference_mismatches",value:1,labels:t})}async handler(e){e.preventDefault(),this.enabled=!this.enabled,this.updateClientStyles(),this.setCookie(),await this.setUserPreference()}handleKeypress(e){"Enter"!==e.key&&"Space"!==e.key||this.handler(e)}render(){return i`<div @click="${this.handler}" @keypress="${this.handleKeypress}">\n <community-colors></community-colors>\n <slot></slot>\n </div>`}};e([t({type:Boolean,reflect:!0})],k.prototype,"enabled",void 0),e([t({type:String})],k.prototype,"country",void 0),e([t({type:String,attribute:"cookie-domain"})],k.prototype,"cookieDomain",void 0),e([t({type:Boolean})],k.prototype,"sync",void 0),k=e([s("shreddit-darkmode-setter")],k);
//# sourceMappingURL=user-drawer-client-js-9a1e731c.js.map
